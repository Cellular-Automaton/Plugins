///
/// TestLenia.cpp
///

#include <gtest/gtest.h>
#include "../../PLC/include/Lenia.hh"

using namespace PLC;

TEST(LeniaTest, DefaultConstructor) {
    std::vector<std::vector<double> > tab_expected = {
        {0,0,0,0,0,0,0.1,0.14,0.1,0,0,0.03,0.03,0,0,0.3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.24,0.3,0.3,0.18,0.14,0.15,0.16,0.15,0.09,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.15,0.34,0.44,0.46,0.38,0.18,0.14,0.11,0.13,0.19,0.18,0.45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0.06,0.13,0.39,0.5,0.5,0.37,0.06,0,0,0,0.02,0.16,0.68,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.11,0.17,0.17,0.33,0.4,0.38,0.28,0.14,0,0,0,0,0,0.18,0.42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.09,0.18,0.13,0.06,0.08,0.26,0.32,0.32,0.27,0,0,0,0,0,0,0.82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0.27,0,0.16,0.12,0,0,0,0.25,0.38,0.44,0.45,0.34,0,0,0,0,0,0.22,0.17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.07,0.2,0.02,0,0,0,0.31,0.48,0.57,0.6,0.57,0,0,0,0,0,0,0.49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.59,0.19,0,0,0,0,0.2,0.57,0.69,0.76,0.76,0.49,0,0,0,0,0,0.36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.58,0.19,0,0,0,0,0,0.67,0.83,0.9,0.92,0.87,0.12,0,0,0,0,0.22,0.07,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.7,0.93,1,1,1,0.61,0,0,0,0,0.18,0.11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.82,0,0,0,0,0,0.47,1,1,0.98,1,0.96,0.27,0,0,0,0.19,0.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.25,1,1,0.84,0.92,0.97,0.54,0.14,0.04,0.1,0.21,0.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.4,0,0,0,0,0.09,0.8,1,0.82,0.8,0.85,0.63,0.31,0.18,0.19,0.2,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.36,0.1,0,0,0,0.05,0.54,0.86,0.79,0.74,0.72,0.6,0.39,0.28,0.24,0.13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.01,0.3,0.07,0,0,0.08,0.36,0.64,0.7,0.64,0.6,0.51,0.39,0.29,0.19,0.04,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0.1,0.24,0.14,0.1,0.15,0.29,0.45,0.53,0.52,0.46,0.4,0.31,0.21,0.08,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.21,0.21,0.22,0.29,0.36,0.39,0.37,0.33,0.26,0.18,0.09,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0.03,0.13,0.19,0.22,0.24,0.24,0.23,0.18,0.13,0.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0.02,0.06,0.08,0.09,0.07,0.05,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    };
    std::vector<std::vector<double> > kernel_expected = {
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0002, 0.0003, 0.0003, 0.0003, 0.0003, 0.0003, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0003, 0.0005, 0.0007, 0.0008, 0.0010, 0.0010, 0.0010, 0.0008, 0.0007, 0.0005, 0.0003, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0004, 0.0008, 0.0011, 0.0016, 0.0019, 0.0021, 0.0022, 0.0021, 0.0019, 0.0016, 0.0011, 0.0008, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0010, 0.0016, 0.0023, 0.0029, 0.0034, 0.0036, 0.0037, 0.0036, 0.0034, 0.0029, 0.0023, 0.0016, 0.0010, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0011, 0.0019, 0.0028, 0.0036, 0.0043, 0.0046, 0.0048, 0.0049, 0.0048, 0.0046, 0.0043, 0.0036, 0.0028, 0.0019, 0.0011, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0002, 0.0004, 0.0010, 0.0019, 0.0030, 0.0040, 0.0047, 0.0050, 0.0050, 0.0049, 0.0049, 0.0049, 0.0050, 0.0050, 0.0047, 0.0040, 0.0030, 0.0019, 0.0010, 0.0004, 0.0002, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0003, 0.0008, 0.0016, 0.0028, 0.0040, 0.0048, 0.0050, 0.0047, 0.0043, 0.0039, 0.0037, 0.0039, 0.0043, 0.0047, 0.0050, 0.0048, 0.0040, 0.0028, 0.0016, 0.0008, 0.0003, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0005, 0.0011, 0.0023, 0.0036, 0.0047, 0.0050, 0.0046, 0.0037, 0.0029, 0.0024, 0.0022, 0.0024, 0.0029, 0.0037, 0.0046, 0.0050, 0.0047, 0.0036, 0.0023, 0.0011, 0.0005, 0.0001, 0.0000, 0.0000},
        {0.0001, 0.0002, 0.0007, 0.0016, 0.0029, 0.0043, 0.0050, 0.0047, 0.0037, 0.0026, 0.0017, 0.0012, 0.0010, 0.0012, 0.0017, 0.0026, 0.0037, 0.0047, 0.0050, 0.0043, 0.0029, 0.0016, 0.0007, 0.0002, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0008, 0.0019, 0.0034, 0.0046, 0.0050, 0.0043, 0.0029, 0.0017, 0.0009, 0.0005, 0.0003, 0.0005, 0.0009, 0.0017, 0.0029, 0.0043, 0.0050, 0.0046, 0.0034, 0.0019, 0.0008, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0021, 0.0036, 0.0048, 0.0049, 0.0039, 0.0024, 0.0012, 0.0005, 0.0002, 0.0001, 0.0002, 0.0005, 0.0012, 0.0024, 0.0039, 0.0049, 0.0048, 0.0036, 0.0021, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0022, 0.0037, 0.0049, 0.0049, 0.0037, 0.0022, 0.0010, 0.0003, 0.0001, 0.0000, 0.0001, 0.0003, 0.0010, 0.0022, 0.0037, 0.0049, 0.0049, 0.0037, 0.0022, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0021, 0.0036, 0.0048, 0.0049, 0.0039, 0.0024, 0.0012, 0.0005, 0.0002, 0.0001, 0.0002, 0.0005, 0.0012, 0.0024, 0.0039, 0.0049, 0.0048, 0.0036, 0.0021, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0008, 0.0019, 0.0034, 0.0046, 0.0050, 0.0043, 0.0029, 0.0017, 0.0009, 0.0005, 0.0003, 0.0005, 0.0009, 0.0017, 0.0029, 0.0043, 0.0050, 0.0046, 0.0034, 0.0019, 0.0008, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0002, 0.0007, 0.0016, 0.0029, 0.0043, 0.0050, 0.0047, 0.0037, 0.0026, 0.0017, 0.0012, 0.0010, 0.0012, 0.0017, 0.0026, 0.0037, 0.0047, 0.0050, 0.0043, 0.0029, 0.0016, 0.0007, 0.0002, 0.0001, 0.0000},
        {0.0000, 0.0001, 0.0005, 0.0011, 0.0023, 0.0036, 0.0047, 0.0050, 0.0046, 0.0037, 0.0029, 0.0024, 0.0022, 0.0024, 0.0029, 0.0037, 0.0046, 0.0050, 0.0047, 0.0036, 0.0023, 0.0011, 0.0005, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0003, 0.0008, 0.0016, 0.0028, 0.0040, 0.0048, 0.0050, 0.0047, 0.0043, 0.0039, 0.0037, 0.0039, 0.0043, 0.0047, 0.0050, 0.0048, 0.0040, 0.0028, 0.0016, 0.0008, 0.0003, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0002, 0.0004, 0.0010, 0.0019, 0.0030, 0.0040, 0.0047, 0.0050, 0.0050, 0.0049, 0.0049, 0.0049, 0.0050, 0.0050, 0.0047, 0.0040, 0.0030, 0.0019, 0.0010, 0.0004, 0.0002, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0011, 0.0019, 0.0028, 0.0036, 0.0043, 0.0046, 0.0048, 0.0049, 0.0048, 0.0046, 0.0043, 0.0036, 0.0028, 0.0019, 0.0011, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0010, 0.0016, 0.0023, 0.0029, 0.0034, 0.0036, 0.0037, 0.0036, 0.0034, 0.0029, 0.0023, 0.0016, 0.0010, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0004, 0.0008, 0.0011, 0.0016, 0.0019, 0.0021, 0.0022, 0.0021, 0.0019, 0.0016, 0.0011, 0.0008, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0003, 0.0005, 0.0007, 0.0008, 0.0010, 0.0010, 0.0010, 0.0008, 0.0007, 0.0005, 0.0003, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0002, 0.0003, 0.0003, 0.0003, 0.0003, 0.0003, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000}
    };
    double mu_expected = 0.15;
    double sigma_expected = 0.015;
    double time_expected = 0.1;

    Lenia l;

    ASSERT_EQ(l.getTab().size(), tab_expected.size());
    for (size_t i = 0; i < l.getTab().size(); i++) {
        ASSERT_EQ(l.getTab()[i].size(), tab_expected[i].size());
        for (size_t j = 0; j < l.getTab()[i].size(); j++) {
            ASSERT_NEAR(l.getTab()[i][j], tab_expected[i][j], 0.01);
        }
    }
    ASSERT_EQ(l.getKernel().size(), kernel_expected.size());
    for (size_t i = 0; i < l.getKernel().size(); i++) {
        ASSERT_EQ(l.getKernel()[i].size(), kernel_expected[i].size());
        for (size_t j = 0; j < l.getKernel()[i].size(); j++) {
            ASSERT_NEAR(l.getKernel()[i][j], kernel_expected[i][j], 0.001);
        }
    }
    ASSERT_EQ(l.getMu(), mu_expected);
    ASSERT_EQ(l.getSigma(), sigma_expected);
    ASSERT_EQ(l.getTime(), time_expected);
}

TEST(LeniaTest, ConstructorWithTabInit) {
    std::vector<std::vector<double> > tab_init = {
        {0.42,0,0,0,0,0,0.1,0.14,0.1,0,0,0.03,0.03,0,0,0.3,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.24,0.3,0.3,0.18,0.14,0.15,0.16,0.15,0.09,0.2,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.15,0.34,0.44,0.46,0.38,0.18,0.14,0.11,0.13,0.19,0.18,0.45,0,0,0,0,0,0},
        {0,0,0,0,0.06,0.13,0.39,0.5,0.5,0.37,0.06,0,0,0,0.02,0.16,0.68,0,0,0,0,0,0},
        {0,0,0,0.11,0.17,0.17,0.33,0.4,0.38,0.28,0.14,0,0,0,0,0,0.18,0.42,0,0,0,0,0},
        {0,0,0.09,0.18,0.13,0.06,0.08,0.26,0.32,0.32,0.27,0,0,0,0,0,0,0.82,0,0,0,0,0},
        {0.27,0,0.16,0.12,0,0,0,0.25,0.38,0.44,0.45,0.34,0,0,0,0,0,0.22,0.17,0,0,0,0},
        {0,0.07,0.2,0.02,0,0,0,0.31,0.48,0.57,0.6,0.57,0,0,0,0,0,0,0.49,0,0,0,0},
        {0,0.59,0.19,0,0,0,0,0.2,0.57,0.69,0.76,0.76,0.49,0,0,0,0,0,0.36,0,0,0,0},
        {0,0.58,0.19,0,0,0,0,0,0.67,0.83,0.9,0.92,0.87,0.12,0,0,0,0,0.22,0.07,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.7,0.93,1,1,1,0.61,0,0,0,0,0.18,0.11,0,0,0},
        {0,0,0.82,0,0,0,0,0,0.47,1,1,0.98,1,0.96,0.27,0,0,0,0.19,0.1,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.25,1,1,0.84,0.92,0.97,0.54,0.14,0.04,0.1,0.21,0.05,0,0,0},
        {0,0,0,0.4,0,0,0,0,0.09,0.8,1,0.82,0.8,0.85,0.63,0.31,0.18,0.19,0.2,0.01,0,0,0},
        {0,0,0,0.36,0.1,0,0,0,0.05,0.54,0.86,0.79,0.74,0.72,0.6,0.39,0.28,0.24,0.13,0,0,0,0},
        {0,0,0,0.01,0.3,0.07,0,0,0.08,0.36,0.64,0.7,0.64,0.6,0.51,0.39,0.29,0.19,0.04,0,0,0,0},
        {0,0,0,0,0.1,0.24,0.14,0.1,0.15,0.29,0.45,0.53,0.52,0.46,0.4,0.31,0.21,0.08,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.21,0.21,0.22,0.29,0.36,0.39,0.37,0.33,0.26,0.18,0.09,0,0,0,0,0,0},
        {0,0,0,0,0,0,0.03,0.13,0.19,0.22,0.24,0.24,0.23,0.18,0.13,0.05,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0.02,0.06,0.08,0.09,0.07,0.05,0.01,0,0,0,0,0,0,0,0},
    };
    std::vector<std::vector<double> > kernel_expected = {
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0002, 0.0003, 0.0003, 0.0003, 0.0003, 0.0003, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0003, 0.0005, 0.0007, 0.0008, 0.0010, 0.0010, 0.0010, 0.0008, 0.0007, 0.0005, 0.0003, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0004, 0.0008, 0.0011, 0.0016, 0.0019, 0.0021, 0.0022, 0.0021, 0.0019, 0.0016, 0.0011, 0.0008, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0010, 0.0016, 0.0023, 0.0029, 0.0034, 0.0036, 0.0037, 0.0036, 0.0034, 0.0029, 0.0023, 0.0016, 0.0010, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0011, 0.0019, 0.0028, 0.0036, 0.0043, 0.0046, 0.0048, 0.0049, 0.0048, 0.0046, 0.0043, 0.0036, 0.0028, 0.0019, 0.0011, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0002, 0.0004, 0.0010, 0.0019, 0.0030, 0.0040, 0.0047, 0.0050, 0.0050, 0.0049, 0.0049, 0.0049, 0.0050, 0.0050, 0.0047, 0.0040, 0.0030, 0.0019, 0.0010, 0.0004, 0.0002, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0003, 0.0008, 0.0016, 0.0028, 0.0040, 0.0048, 0.0050, 0.0047, 0.0043, 0.0039, 0.0037, 0.0039, 0.0043, 0.0047, 0.0050, 0.0048, 0.0040, 0.0028, 0.0016, 0.0008, 0.0003, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0005, 0.0011, 0.0023, 0.0036, 0.0047, 0.0050, 0.0046, 0.0037, 0.0029, 0.0024, 0.0022, 0.0024, 0.0029, 0.0037, 0.0046, 0.0050, 0.0047, 0.0036, 0.0023, 0.0011, 0.0005, 0.0001, 0.0000, 0.0000},
        {0.0001, 0.0002, 0.0007, 0.0016, 0.0029, 0.0043, 0.0050, 0.0047, 0.0037, 0.0026, 0.0017, 0.0012, 0.0010, 0.0012, 0.0017, 0.0026, 0.0037, 0.0047, 0.0050, 0.0043, 0.0029, 0.0016, 0.0007, 0.0002, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0008, 0.0019, 0.0034, 0.0046, 0.0050, 0.0043, 0.0029, 0.0017, 0.0009, 0.0005, 0.0003, 0.0005, 0.0009, 0.0017, 0.0029, 0.0043, 0.0050, 0.0046, 0.0034, 0.0019, 0.0008, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0021, 0.0036, 0.0048, 0.0049, 0.0039, 0.0024, 0.0012, 0.0005, 0.0002, 0.0001, 0.0002, 0.0005, 0.0012, 0.0024, 0.0039, 0.0049, 0.0048, 0.0036, 0.0021, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0022, 0.0037, 0.0049, 0.0049, 0.0037, 0.0022, 0.0010, 0.0003, 0.0001, 0.0000, 0.0001, 0.0003, 0.0010, 0.0022, 0.0037, 0.0049, 0.0049, 0.0037, 0.0022, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0021, 0.0036, 0.0048, 0.0049, 0.0039, 0.0024, 0.0012, 0.0005, 0.0002, 0.0001, 0.0002, 0.0005, 0.0012, 0.0024, 0.0039, 0.0049, 0.0048, 0.0036, 0.0021, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0008, 0.0019, 0.0034, 0.0046, 0.0050, 0.0043, 0.0029, 0.0017, 0.0009, 0.0005, 0.0003, 0.0005, 0.0009, 0.0017, 0.0029, 0.0043, 0.0050, 0.0046, 0.0034, 0.0019, 0.0008, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0002, 0.0007, 0.0016, 0.0029, 0.0043, 0.0050, 0.0047, 0.0037, 0.0026, 0.0017, 0.0012, 0.0010, 0.0012, 0.0017, 0.0026, 0.0037, 0.0047, 0.0050, 0.0043, 0.0029, 0.0016, 0.0007, 0.0002, 0.0001, 0.0000},
        {0.0000, 0.0001, 0.0005, 0.0011, 0.0023, 0.0036, 0.0047, 0.0050, 0.0046, 0.0037, 0.0029, 0.0024, 0.0022, 0.0024, 0.0029, 0.0037, 0.0046, 0.0050, 0.0047, 0.0036, 0.0023, 0.0011, 0.0005, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0003, 0.0008, 0.0016, 0.0028, 0.0040, 0.0048, 0.0050, 0.0047, 0.0043, 0.0039, 0.0037, 0.0039, 0.0043, 0.0047, 0.0050, 0.0048, 0.0040, 0.0028, 0.0016, 0.0008, 0.0003, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0002, 0.0004, 0.0010, 0.0019, 0.0030, 0.0040, 0.0047, 0.0050, 0.0050, 0.0049, 0.0049, 0.0049, 0.0050, 0.0050, 0.0047, 0.0040, 0.0030, 0.0019, 0.0010, 0.0004, 0.0002, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0011, 0.0019, 0.0028, 0.0036, 0.0043, 0.0046, 0.0048, 0.0049, 0.0048, 0.0046, 0.0043, 0.0036, 0.0028, 0.0019, 0.0011, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0010, 0.0016, 0.0023, 0.0029, 0.0034, 0.0036, 0.0037, 0.0036, 0.0034, 0.0029, 0.0023, 0.0016, 0.0010, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0004, 0.0008, 0.0011, 0.0016, 0.0019, 0.0021, 0.0022, 0.0021, 0.0019, 0.0016, 0.0011, 0.0008, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0003, 0.0005, 0.0007, 0.0008, 0.0010, 0.0010, 0.0010, 0.0008, 0.0007, 0.0005, 0.0003, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0002, 0.0003, 0.0003, 0.0003, 0.0003, 0.0003, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000}
    };
    double mu_expected = 0.15;
    double sigma_expected = 0.015;
    double time_expected = 0.1;

    Lenia l(tab_init);

    ASSERT_EQ(l.getTab().size(), tab_init.size());
    for (size_t i = 0; i < l.getTab().size(); i++) {
        ASSERT_EQ(l.getTab()[i].size(), tab_init[i].size());
        for (size_t j = 0; j < l.getTab()[i].size(); j++) {
            ASSERT_NEAR(l.getTab()[i][j], tab_init[i][j], 0.01);
        }
    }
    ASSERT_EQ(l.getKernel().size(), kernel_expected.size());
    for (size_t i = 0; i < l.getKernel().size(); i++) {
        ASSERT_EQ(l.getKernel()[i].size(), kernel_expected[i].size());
        for (size_t j = 0; j < l.getKernel()[i].size(); j++) {
            ASSERT_NEAR(l.getKernel()[i][j], kernel_expected[i][j], 0.001);
        }
    }
    ASSERT_EQ(l.getMu(), mu_expected);
    ASSERT_EQ(l.getSigma(), sigma_expected);
    ASSERT_EQ(l.getTime(), time_expected);
}

TEST(LeniaTest, ConstructorWithTabInitKernelInitAndGrowthInit) {
    std::vector<std::vector<double> > tab_init = {
        {0.43,0,0,0,0,0,0.1,0.14,0.1,0,0,0.03,0.03,0,0,0.3,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.24,0.3,0.3,0.18,0.14,0.15,0.16,0.15,0.09,0.2,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.15,0.34,0.44,0.46,0.38,0.18,0.14,0.11,0.13,0.19,0.18,0.45,0,0,0,0,0,0},
        {0,0,0,0,0.06,0.13,0.39,0.5,0.5,0.37,0.06,0,0,0,0.02,0.16,0.68,0,0,0,0,0,0},
        {0,0,0,0.11,0.17,0.17,0.33,0.4,0.38,0.28,0.14,0,0,0,0,0,0.18,0.42,0,0,0,0,0},
        {0,0,0.09,0.18,0.13,0.06,0.08,0.26,0.32,0.32,0.27,0,0,0,0,0,0,0.82,0,0,0,0,0},
        {0.27,0,0.16,0.12,0,0,0,0.25,0.38,0.44,0.45,0.34,0,0,0,0,0,0.22,0.17,0,0,0,0},
        {0,0.07,0.2,0.02,0,0,0,0.31,0.48,0.57,0.6,0.57,0,0,0,0,0,0,0.49,0,0,0,0},
        {0,0.59,0.19,0,0,0,0,0.2,0.57,0.69,0.76,0.76,0.49,0,0,0,0,0,0.36,0,0,0,0},
        {0,0.58,0.19,0,0,0,0,0,0.67,0.83,0.9,0.92,0.87,0.12,0,0,0,0,0.22,0.07,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.7,0.93,1,1,1,0.61,0,0,0,0,0.18,0.11,0,0,0},
        {0,0,0.82,0,0,0,0,0,0.47,1,1,0.98,1,0.96,0.27,0,0,0,0.19,0.1,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.25,1,1,0.84,0.92,0.97,0.54,0.14,0.04,0.1,0.21,0.05,0,0,0},
        {0,0,0,0.4,0,0,0,0,0.09,0.8,1,0.82,0.8,0.85,0.63,0.31,0.18,0.19,0.2,0.01,0,0,0},
        {0,0,0,0.36,0.1,0,0,0,0.05,0.54,0.86,0.79,0.74,0.72,0.6,0.39,0.28,0.24,0.13,0,0,0,0},
        {0,0,0,0.01,0.3,0.07,0,0,0.08,0.36,0.64,0.7,0.64,0.6,0.51,0.39,0.29,0.19,0.04,0,0,0,0},
        {0,0,0,0,0.1,0.24,0.14,0.1,0.15,0.29,0.45,0.53,0.52,0.46,0.4,0.31,0.21,0.08,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.21,0.21,0.22,0.29,0.36,0.39,0.37,0.33,0.26,0.18,0.09,0,0,0,0,0,0},
        {0,0,0,0,0,0,0.03,0.13,0.19,0.22,0.24,0.24,0.23,0.18,0.13,0.05,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0.02,0.06,0.08,0.09,0.07,0.05,0.01,0,0,0,0,0,0,0,0},
    };
    int R_init = 18;
    double kernel_mu_init = 0.2;
    double kernel_sigma_init = 0.06;
    double growth_mu_init = 0.43;
    double growth_sigma_init = 0.42;

    Lenia l(tab_init, R_init, kernel_mu_init, kernel_sigma_init, growth_mu_init, growth_sigma_init);

    double time_expected = 0.1;

    ASSERT_EQ(l.getTab().size(), tab_init.size());
    for (size_t i = 0; i < l.getTab().size(); i++) {
        ASSERT_EQ(l.getTab()[i].size(), tab_init[i].size());
        for (size_t j = 0; j < l.getTab()[i].size(); j++) {
            ASSERT_NEAR(l.getTab()[i][j], tab_init[i][j], 0.01);
        }
    }
    ASSERT_EQ(l.getMu(), growth_mu_init);
    ASSERT_EQ(l.getSigma(), growth_sigma_init);
    ASSERT_EQ(l.getTime(), time_expected);
}

TEST(LeniaTest, ConstructorWithAllInit) {
    std::vector<std::vector<double> > tab_init = {
        {0.43,0,0,0,0,0,0.1,0.14,0.1,0,0,0.03,0.03,0,0,0.3,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.24,0.3,0.3,0.18,0.14,0.15,0.16,0.15,0.09,0.2,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.15,0.34,0.44,0.46,0.38,0.18,0.14,0.11,0.13,0.19,0.18,0.45,0,0,0,0,0,0},
        {0,0,0,0,0.06,0.13,0.39,0.5,0.5,0.37,0.06,0,0,0,0.02,0.16,0.68,0,0,0,0,0,0},
        {0,0,0,0.11,0.17,0.17,0.33,0.4,0.38,0.28,0.14,0,0,0,0,0,0.18,0.42,0,0,0,0,0},
        {0,0,0.09,0.18,0.13,0.06,0.08,0.26,0.32,0.32,0.27,0,0,0,0,0,0,0.82,0,0,0,0,0},
        {0.27,0,0.16,0.12,0,0,0,0.25,0.38,0.44,0.45,0.34,0,0,0,0,0,0.22,0.17,0,0,0,0},
        {0,0.07,0.2,0.02,0,0,0,0.31,0.48,0.57,0.6,0.57,0,0,0,0,0,0,0.49,0,0,0,0},
        {0,0.59,0.19,0,0,0,0,0.2,0.57,0.69,0.76,0.76,0.49,0,0,0,0,0,0.36,0,0,0,0},
        {0,0.58,0.19,0,0,0,0,0,0.67,0.83,0.9,0.92,0.87,0.12,0,0,0,0,0.22,0.07,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.7,0.93,1,1,1,0.61,0,0,0,0,0.18,0.11,0,0,0},
        {0,0,0.82,0,0,0,0,0,0.47,1,1,0.98,1,0.96,0.27,0,0,0,0.19,0.1,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.25,1,1,0.84,0.92,0.97,0.54,0.14,0.04,0.1,0.21,0.05,0,0,0},
        {0,0,0,0.4,0,0,0,0,0.09,0.8,1,0.82,0.8,0.85,0.63,0.31,0.18,0.19,0.2,0.01,0,0,0},
        {0,0,0,0.36,0.1,0,0,0,0.05,0.54,0.86,0.79,0.74,0.72,0.6,0.39,0.28,0.24,0.13,0,0,0,0},
        {0,0,0,0.01,0.3,0.07,0,0,0.08,0.36,0.64,0.7,0.64,0.6,0.51,0.39,0.29,0.19,0.04,0,0,0,0},
        {0,0,0,0,0.1,0.24,0.14,0.1,0.15,0.29,0.45,0.53,0.52,0.46,0.4,0.31,0.21,0.08,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.21,0.21,0.22,0.29,0.36,0.39,0.37,0.33,0.26,0.18,0.09,0,0,0,0,0,0},
        {0,0,0,0,0,0,0.03,0.13,0.19,0.22,0.24,0.24,0.23,0.18,0.13,0.05,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0.02,0.06,0.08,0.09,0.07,0.05,0.01,0,0,0,0,0,0,0,0},
    };
    std::vector<std::vector<double> > kernel_init = {
        {0.0043, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0003, 0.0007, 0.0012, 0.0014, 0.0012, 0.0007, 0.0003, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0006, 0.0019, 0.0042, 0.0062, 0.0070, 0.0062, 0.0042, 0.0019, 0.0006, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0006, 0.0027, 0.0070, 0.0118, 0.0145, 0.0152, 0.0145, 0.0118, 0.0070, 0.0027, 0.0006, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0003, 0.0019, 0.0070, 0.0137, 0.0163, 0.0150, 0.0140, 0.0150, 0.0163, 0.0137, 0.0070, 0.0019, 0.0003, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0007, 0.0042, 0.0118, 0.0163, 0.0127, 0.0074, 0.0055, 0.0074, 0.0127, 0.0163, 0.0118, 0.0042, 0.0007, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0012, 0.0062, 0.0145, 0.0150, 0.0074, 0.0021, 0.0009, 0.0021, 0.0074, 0.0150, 0.0145, 0.0062, 0.0012, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0014, 0.0070, 0.0152, 0.0140, 0.0055, 0.0009, 0.0001, 0.0009, 0.0055, 0.0140, 0.0152, 0.0070, 0.0014, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0012, 0.0062, 0.0145, 0.0150, 0.0074, 0.0021, 0.0009, 0.0021, 0.0074, 0.0150, 0.0145, 0.0062, 0.0012, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0007, 0.0042, 0.0118, 0.0163, 0.0127, 0.0074, 0.0055, 0.0074, 0.0127, 0.0163, 0.0118, 0.0042, 0.0007, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0003, 0.0019, 0.0070, 0.0137, 0.0163, 0.0150, 0.0140, 0.0150, 0.0163, 0.0137, 0.0070, 0.0019, 0.0003, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0006, 0.0027, 0.0070, 0.0118, 0.0145, 0.0152, 0.0145, 0.0118, 0.0070, 0.0027, 0.0006, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0006, 0.0019, 0.0042, 0.0062, 0.0070, 0.0062, 0.0042, 0.0019, 0.0006, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0003, 0.0007, 0.0012, 0.0014, 0.0012, 0.0007, 0.0003, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000}
    };
    double growth_mu_init = 0.43;
    double growth_sigma_init = 0.42;
    double time_init = 0.56;

    Lenia l(tab_init, kernel_init, time_init, growth_mu_init, growth_sigma_init);

    ASSERT_EQ(l.getTab().size(), tab_init.size());
    for (size_t i = 0; i < l.getTab().size(); i++) {
        ASSERT_EQ(l.getTab()[i].size(), tab_init[i].size());
        for (size_t j = 0; j < l.getTab()[i].size(); j++) {
            ASSERT_NEAR(l.getTab()[i][j], tab_init[i][j], 0.01);
        }
    }
    ASSERT_EQ(l.getKernel().size(), kernel_init.size());
    for (size_t i = 0; i < l.getKernel().size(); i++) {
        ASSERT_EQ(l.getKernel()[i].size(), kernel_init[i].size());
        for (size_t j = 0; j < l.getKernel()[i].size(); j++) {
            ASSERT_NEAR(l.getKernel()[i][j], kernel_init[i][j], 0.001);
        }
    }
    ASSERT_EQ(l.getMu(), growth_mu_init);
    ASSERT_EQ(l.getSigma(), growth_sigma_init);
    ASSERT_EQ(l.getTime(), time_init);
}

TEST(LeniaTest, CreateKernel) {

    std::vector<std::vector<double> > kernel1_expected = {
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00003, 0.00005, 0.00007, 0.00009, 0.00009, 0.00009, 0.00007, 0.00005, 0.00003, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00004, 0.00008, 0.00014, 0.00021, 0.00028, 0.00033, 0.00035, 0.00033, 0.00028, 0.00021, 0.00014, 0.00008, 0.00004, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00003, 0.00007, 0.00015, 0.00028, 0.00046, 0.00065, 0.00083, 0.00096, 0.00100, 0.00096, 0.00083, 0.00065, 0.00046, 0.00028, 0.00015, 0.00007, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00003, 0.00009, 0.00021, 0.00043, 0.00075, 0.00115, 0.00155, 0.00190, 0.00212, 0.00220, 0.00212, 0.00190, 0.00155, 0.00115, 0.00075, 0.00043, 0.00021, 0.00009, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00003, 0.00009, 0.00024, 0.00053, 0.00100, 0.00162, 0.00229, 0.00289, 0.00336, 0.00364, 0.00373, 0.00364, 0.00336, 0.00289, 0.00229, 0.00162, 0.00100, 0.00053, 0.00024, 0.00009, 0.00003, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00007, 0.00021, 0.00053, 0.00110, 0.00190, 0.00280, 0.00364, 0.00426, 0.00463, 0.00480, 0.00485, 0.00480, 0.00463, 0.00426, 0.00364, 0.00280, 0.00190, 0.00110, 0.00053, 0.00021, 0.00007, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00004, 0.00015, 0.00043, 0.00100, 0.00190, 0.00299, 0.00400, 0.00469, 0.00499, 0.00499, 0.00490, 0.00485, 0.00490, 0.00499, 0.00499, 0.00469, 0.00400, 0.00299, 0.00190, 0.00100, 0.00043, 0.00015, 0.00004, 0.00000, 0.00000},
        {0.00002, 0.00008, 0.00028, 0.00075, 0.00162, 0.00280, 0.00400, 0.00480, 0.00501, 0.00473, 0.00426, 0.00387, 0.00373, 0.00387, 0.00426, 0.00473, 0.00501, 0.00480, 0.00400, 0.00280, 0.00162, 0.00075, 0.00028, 0.00008, 0.00002, 0.00000},
        {0.00003, 0.00014, 0.00046, 0.00115, 0.00229, 0.00364, 0.00469, 0.00501, 0.00457, 0.00373, 0.00292, 0.00239, 0.00220, 0.00239, 0.00292, 0.00373, 0.00457, 0.00501, 0.00469, 0.00364, 0.00229, 0.00115, 0.00046, 0.00014, 0.00003, 0.00000},
        {0.00005, 0.00021, 0.00065, 0.00155, 0.00289, 0.00426, 0.00499, 0.00473, 0.00373, 0.00257, 0.00167, 0.00116, 0.00100, 0.00116, 0.00167, 0.00257, 0.00373, 0.00473, 0.00499, 0.00426, 0.00289, 0.00155, 0.00065, 0.00021, 0.00005, 0.00000},
        {0.00007, 0.00028, 0.00083, 0.00190, 0.00336, 0.00463, 0.00499, 0.00426, 0.00292, 0.00167, 0.00085, 0.00046, 0.00035, 0.00046, 0.00085, 0.00167, 0.00292, 0.00426, 0.00499, 0.00463, 0.00336, 0.00190, 0.00083, 0.00028, 0.00007, 0.00000},
        {0.00009, 0.00033, 0.00096, 0.00212, 0.00364, 0.00480, 0.00490, 0.00387, 0.00239, 0.00116, 0.00046, 0.00017, 0.00009, 0.00017, 0.00046, 0.00116, 0.00239, 0.00387, 0.00490, 0.00480, 0.00364, 0.00212, 0.00096, 0.00033, 0.00009, 0.00000},
        {0.00009, 0.00035, 0.00100, 0.00220, 0.00373, 0.00485, 0.00485, 0.00373, 0.00220, 0.00100, 0.00035, 0.00009, 0.00002, 0.00009, 0.00035, 0.00100, 0.00220, 0.00373, 0.00485, 0.00485, 0.00373, 0.00220, 0.00100, 0.00035, 0.00009, 0.00002},
        {0.00009, 0.00033, 0.00096, 0.00212, 0.00364, 0.00480, 0.00490, 0.00387, 0.00239, 0.00116, 0.00046, 0.00017, 0.00009, 0.00017, 0.00046, 0.00116, 0.00239, 0.00387, 0.00490, 0.00480, 0.00364, 0.00212, 0.00096, 0.00033, 0.00009, 0.00000},
        {0.00007, 0.00028, 0.00083, 0.00190, 0.00336, 0.00463, 0.00499, 0.00426, 0.00292, 0.00167, 0.00085, 0.00046, 0.00035, 0.00046, 0.00085, 0.00167, 0.00292, 0.00426, 0.00499, 0.00463, 0.00336, 0.00190, 0.00083, 0.00028, 0.00007, 0.00000},
        {0.00005, 0.00021, 0.00065, 0.00155, 0.00289, 0.00426, 0.00499, 0.00473, 0.00373, 0.00257, 0.00167, 0.00116, 0.00100, 0.00116, 0.00167, 0.00257, 0.00373, 0.00473, 0.00499, 0.00426, 0.00289, 0.00155, 0.00065, 0.00021, 0.00005, 0.00000},
        {0.00003, 0.00014, 0.00046, 0.00115, 0.00229, 0.00364, 0.00469, 0.00501, 0.00457, 0.00373, 0.00292, 0.00239, 0.00220, 0.00239, 0.00292, 0.00373, 0.00457, 0.00501, 0.00469, 0.00364, 0.00229, 0.00115, 0.00046, 0.00014, 0.00003, 0.00000},
        {0.00002, 0.00008, 0.00028, 0.00075, 0.00162, 0.00280, 0.00400, 0.00480, 0.00501, 0.00473, 0.00426, 0.00387, 0.00373, 0.00387, 0.00426, 0.00473, 0.00501, 0.00480, 0.00400, 0.00280, 0.00162, 0.00075, 0.00028, 0.00008, 0.00002, 0.00000},
        {0.00000, 0.00004, 0.00015, 0.00043, 0.00100, 0.00190, 0.00299, 0.00400, 0.00469, 0.00499, 0.00499, 0.00490, 0.00485, 0.00490, 0.00499, 0.00499, 0.00469, 0.00400, 0.00299, 0.00190, 0.00100, 0.00043, 0.00015, 0.00004, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00007, 0.00021, 0.00053, 0.00110, 0.00190, 0.00280, 0.00364, 0.00426, 0.00463, 0.00480, 0.00485, 0.00480, 0.00463, 0.00426, 0.00364, 0.00280, 0.00190, 0.00110, 0.00053, 0.00021, 0.00007, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00003, 0.00009, 0.00024, 0.00053, 0.00100, 0.00162, 0.00229, 0.00289, 0.00336, 0.00364, 0.00373, 0.00364, 0.00336, 0.00289, 0.00229, 0.00162, 0.00100, 0.00053, 0.00024, 0.00009, 0.00003, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00003, 0.00009, 0.00021, 0.00043, 0.00075, 0.00115, 0.00155, 0.00190, 0.00212, 0.00220, 0.00212, 0.00190, 0.00155, 0.00115, 0.00075, 0.00043, 0.00021, 0.00009, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00003, 0.00007, 0.00015, 0.00028, 0.00046, 0.00065, 0.00083, 0.00096, 0.00100, 0.00096, 0.00083, 0.00065, 0.00046, 0.00028, 0.00015, 0.00007, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00004, 0.00008, 0.00014, 0.00021, 0.00028, 0.00033, 0.00035, 0.00033, 0.00028, 0.00021, 0.00014, 0.00008, 0.00004, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00003, 0.00005, 0.00007, 0.00009, 0.00009, 0.00009, 0.00007, 0.00005, 0.00003, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000}
    };

    Lenia l;
    std::vector<std::vector<double> > kernel1 = l.createKernel(13, 0.5, 0.15);

    ASSERT_EQ(kernel1_expected.size(), kernel1.size());
    for (size_t i = 0; i < kernel1_expected.size(); i++) {
        ASSERT_EQ(kernel1_expected[i].size(), kernel1[i].size());
        for (size_t j = 0; j < kernel1_expected[i].size(); j++) {
            ASSERT_NEAR(kernel1_expected[i][j], kernel1[i][j], 0.0001);
        }
    }
}

TEST(LeniaTest, Growth) {

    Lenia l;
    std::vector<std::vector<double> > a = {{}};

    for (double i = 0; i < 0.3; i += 0.001) {
        a[0].push_back(i);
    }

    std::vector<std::vector<double> > result = l.growth(a);
    std::vector<std::vector<double> > result_expected ={
        {-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.9999999999999999, -0.9999999999999998, -0.9999999999999997, -0.9999999999999994, -0.999999999999999, -0.9999999999999983, -0.9999999999999971, -0.999999999999995, -0.9999999999999913, -0.9999999999999851, -0.9999999999999747, -0.9999999999999569, -0.9999999999999271, -0.999999999999877, -0.9999999999997936, -0.9999999999996552, -0.9999999999994265, -0.9999999999990501, -0.9999999999984338, -0.9999999999974293, -0.9999999999957991, -0.9999999999931658, -0.9999999999889307, -0.999999999982151, -0.9999999999713464, -0.9999999999542053, -0.9999999999271347, -0.999999999884576, -0.9999999998179706, -0.9999999997142037, -0.9999999995532737, -0.9999999993048218, -0.9999999989229877, -0.9999999983388268, -0.9999999974491848, -0.9999999961004644, -0.9999999940650568, -0.9999999910073011, -0.999999986434577, -0.9999999796274013, -0.9999999695400406, -0.9999999546599478, -0.9999999328100201, -0.9999999008718936, -0.9999998544008261, -0.9999997870925718, -0.9999996900493728, -0.9999995507748864, -0.9999993518055067, -0.9999990688568569, -0.999998668327706, -0.9999981039574423, -0.9999973123754448, -0.9999962072089117, -0.999994671327299, -0.9999925466936559, -0.9999896211627866, -0.999985611410217, -0.9999801409913883, -0.9999727123145965, -0.999962671061773, -0.9999491613069676, -0.9999310692634051, -0.9999069532380948, -0.9998749569924503, -0.9998327033055405, -0.9997771641244741, -0.999704503279536, -0.9996098873606374, -0.9994872600227889, -0.999329074744195, -0.9991259809402006, -0.9988664583850267, -0.998536395162239, -0.9981186049102642, -0.9975922800103436, -0.9969323786413511, -0.9961089453570682, -0.9950863670790214, -0.9938225691835264, -0.9922681597210543, -0.9903655337437877, -0.988047954209988, -0.9852386309246515, -0.9818498243686968, -0.9777820069235154, -0.9729231197266952, -0.9671479689622289, -0.9603178105112594, -0.9522801762412395, -0.9428689984308992, -0.9319050905308013, -0.9191970422516734, -0.9045425844736716, -0.8877304743317324, -0.8685429427669388, -0.8467587356390128, -0.8221567650812271, -0.794520370195011, -0.7636421656364386, -0.7293294335267746, -0.6914099889968633, -0.6497384233096979, -0.6042026018327705, -0.5547302682422179, -0.5012955824454073, -0.4439253990936114, -0.38270507752676175, -0.31778360380681536, -0.2493778022972003, -0.17777541898562454, -0.10333687211811315, -0.026495488080055862, 0.05224392818691381, 0.13230829903439623, 0.21306131942526796, 0.293810350928706, 0.3738151149147768, 0.452298074147383, 0.5284563303429823, 0.6014748058336175, 0.6705404228225453, 0.7348569463668229, 0.7936601194937387, 0.8462326927732726, 0.8919189378135308, 0.9301382355793606, 0.9603973466135105, 0.9823010009765698, 0.9955604901712127, 1.0, 0.9955604901712127, 0.9823010009765698, 0.9603973466135105, 0.9301382355793606, 0.8919189378135308, 0.8462326927732713, 0.7936601194937372, 0.7348569463668211, 0.6705404228225436, 0.6014748058336155, 0.5284563303429801, 0.452298074147381, 0.3738151149147746, 0.29381035092870356, 0.21306131942526574, 0.13230829903439378, 0.05224392818691159, -0.026495488080057972, -0.10333687211811537, -0.17777541898562654, -0.2493778022972022, -0.31778360380681736, -0.3827050775267634, -0.44392539909361295, -0.5012955824454088, -0.5547302682422179, -0.6042026018327705, -0.6497384233096979, -0.6914099889968633, -0.7293294335267746, -0.7636421656364389, -0.7945203701950113, -0.8221567650812274, -0.8467587356390132, -0.8685429427669391, -0.8877304743317327, -0.9045425844736719, -0.9191970422516735, -0.9319050905308014, -0.9428689984308993, -0.9522801762412396, -0.9603178105112595, -0.967147968962229, -0.9729231197266953, -0.9777820069235155, -0.9818498243686969, -0.9852386309246516, -0.9880479542099881, -0.9903655337437877, -0.9922681597210544, -0.9938225691835265, -0.9950863670790214, -0.9961089453570682, -0.9969323786413511, -0.9975922800103436, -0.9981186049102642, -0.998536395162239, -0.9988664583850267, -0.9991259809402006, -0.999329074744195, -0.9994872600227889, -0.9996098873606374, -0.999704503279536, -0.9997771641244741, -0.9998327033055405, -0.9998749569924503, -0.9999069532380948, -0.9999310692634051, -0.9999491613069676, -0.999962671061773, -0.9999727123145965, -0.9999801409913883, -0.999985611410217, -0.9999896211627866, -0.9999925466936559, -0.999994671327299, -0.9999962072089117, -0.9999973123754448, -0.9999981039574423, -0.999998668327706, -0.9999990688568569, -0.9999993518055067, -0.9999995507748864, -0.9999996900493728, -0.9999997870925718, -0.9999998544008261, -0.9999999008718936, -0.9999999328100201, -0.9999999546599478, -0.9999999695400406, -0.9999999796274013, -0.999999986434577, -0.9999999910073011, -0.9999999940650568, -0.9999999961004644, -0.9999999974491848, -0.9999999983388268, -0.9999999989229877, -0.9999999993048218, -0.9999999995532737, -0.9999999997142037, -0.9999999998179706, -0.999999999884576, -0.9999999999271347, -0.9999999999542053, -0.9999999999713464, -0.999999999982151, -0.9999999999889307, -0.9999999999931658, -0.9999999999957991, -0.9999999999974293, -0.9999999999984338, -0.9999999999990501, -0.9999999999994265, -0.9999999999996552, -0.9999999999997936, -0.999999999999877, -0.9999999999999271, -0.9999999999999569, -0.9999999999999747, -0.9999999999999851, -0.9999999999999913, -0.999999999999995, -0.9999999999999971, -0.9999999999999983, -0.999999999999999, -0.9999999999999994, -0.9999999999999997, -0.9999999999999998, -0.9999999999999999, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0}
    };

    ASSERT_EQ(result[0].size(), result_expected[0].size());
    for (size_t i = 0; i < result[0].size(); i++) {
        ASSERT_NEAR(result[0][i], result_expected[0][i], 0.00000000000001); // more = error
    }
}

TEST(LeniaTest, Activate) {

    Lenia l;

    size_t nb_loop = 3;
    auto result = l.activate(nb_loop);

    ASSERT_EQ(result.size(), nb_loop);
}

TEST(LeniaTest, Calculate) {

    std::vector<std::vector<double> > m = {
        {0.10000, 0.20000, 0.30000, 0.30000, 0.20000, 0.10000},
        {0.40000, 0.50000, 0.60000, 0.60000, 0.50000, 0.40000},
        {0.70000, 0.80000, 0.90000, 0.90000, 0.80000, 0.70000},
        {0.70000, 0.80000, 0.90000, 0.90000, 0.80000, 0.70000},
        {0.40000, 0.50000, 0.60000, 0.60000, 0.50000, 0.40000},
        {0.10000, 0.20000, 0.30000, 0.30000, 0.20000, 0.10000}
    };
    Lenia t(m, 3, 0.5, 0.15, 0, 0);
    std::vector<std::vector<double> > k = {
        {0.00123, 0.02522, 0.05184, 0.02522, 0.00123, 0.00000},
        {0.02522, 0.09437, 0.05184, 0.09437, 0.02522, 0.00000},
        {0.05184, 0.05184, 0.00037, 0.05184, 0.05184, 0.00037},
        {0.02522, 0.09437, 0.05184, 0.09437, 0.02522, 0.00000},
        {0.00123, 0.02522, 0.05184, 0.02522, 0.00123, 0.00000},
        {0.00000, 0.00000, 0.00037, 0.00000, 0.00000, 0.00000}
    };

    EXPECT_EQ(t.getTab().size(), m.size());
    for (size_t i = 0; i < t.getTab().size(); i++) {
        EXPECT_EQ(t.getTab()[i].size(), m[i].size());
        for (size_t j = 0; j < t.getTab()[i].size(); j++) {
            EXPECT_NEAR(t.getTab()[i][j], m[i][j], 0.01);
        }
    }
    EXPECT_EQ(t.getKernel().size(), k.size());
    for (size_t i = 0; i < t.getKernel().size(); i++) {
        EXPECT_EQ(t.getKernel()[i].size(), k[i].size());
        for (size_t j = 0; j < t.getKernel()[i].size(); j++) {
            EXPECT_NEAR(t.getKernel()[i][j], k[i][j], 0.001);
        }
    }

    std::vector<std::vector<double> > r = t.calculate();
    std::vector<std::vector<double> > r_e = {
        {0.34240, 0.38180, 0.42120, 0.42120, 0.38180, 0.34240},
        {0.46060, 0.50000, 0.53940, 0.53940, 0.50000, 0.46060},
        {0.57880, 0.61820, 0.65760, 0.65760, 0.61820, 0.57880},
        {0.57880, 0.61820, 0.65760, 0.65760, 0.61820, 0.57880},
        {0.46060, 0.50000, 0.53940, 0.53940, 0.50000, 0.46060},
        {0.34240, 0.38180, 0.42120, 0.42120, 0.38180, 0.34240}
    };

    ASSERT_EQ(r_e.size(), r.size());
    for (size_t i = 0; i < r_e.size(); i++) {
        ASSERT_EQ(r_e[i].size(), r[i].size());
        for (size_t j = 0; j < r_e[i].size(); j++) {
            ASSERT_NEAR(r_e[i][j], r[i][j], 0.001);
        }
    }

    std::vector<std::vector<double> > tab_expected = {
        {0,0,0,0,0,0,0.1,0.14,0.1,0,0,0.03,0.03,0,0,0.3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.24,0.3,0.3,0.18,0.14,0.15,0.16,0.15,0.09,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.15,0.34,0.44,0.46,0.38,0.18,0.14,0.11,0.13,0.19,0.18,0.45,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0.06,0.13,0.39,0.5,0.5,0.37,0.06,0,0,0,0.02,0.16,0.68,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.11,0.17,0.17,0.33,0.4,0.38,0.28,0.14,0,0,0,0,0,0.18,0.42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.09,0.18,0.13,0.06,0.08,0.26,0.32,0.32,0.27,0,0,0,0,0,0,0.82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0.27,0,0.16,0.12,0,0,0,0.25,0.38,0.44,0.45,0.34,0,0,0,0,0,0.22,0.17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.07,0.2,0.02,0,0,0,0.31,0.48,0.57,0.6,0.57,0,0,0,0,0,0,0.49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.59,0.19,0,0,0,0,0.2,0.57,0.69,0.76,0.76,0.49,0,0,0,0,0,0.36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0.58,0.19,0,0,0,0,0,0.67,0.83,0.9,0.92,0.87,0.12,0,0,0,0,0.22,0.07,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.7,0.93,1,1,1,0.61,0,0,0,0,0.18,0.11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.82,0,0,0,0,0,0.47,1,1,0.98,1,0.96,0.27,0,0,0,0.19,0.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0.46,0,0,0,0,0,0.25,1,1,0.84,0.92,0.97,0.54,0.14,0.04,0.1,0.21,0.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.4,0,0,0,0,0.09,0.8,1,0.82,0.8,0.85,0.63,0.31,0.18,0.19,0.2,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.36,0.1,0,0,0,0.05,0.54,0.86,0.79,0.74,0.72,0.6,0.39,0.28,0.24,0.13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0.01,0.3,0.07,0,0,0.08,0.36,0.64,0.7,0.64,0.6,0.51,0.39,0.29,0.19,0.04,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0.1,0.24,0.14,0.1,0.15,0.29,0.45,0.53,0.52,0.46,0.4,0.31,0.21,0.08,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0.08,0.21,0.21,0.22,0.29,0.36,0.39,0.37,0.33,0.26,0.18,0.09,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0.03,0.13,0.19,0.22,0.24,0.24,0.23,0.18,0.13,0.05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0.02,0.06,0.08,0.09,0.07,0.05,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    };
    std::vector<std::vector<double> > kernel_expected = {
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0002, 0.0003, 0.0003, 0.0003, 0.0003, 0.0003, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0003, 0.0005, 0.0007, 0.0008, 0.0010, 0.0010, 0.0010, 0.0008, 0.0007, 0.0005, 0.0003, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0004, 0.0008, 0.0011, 0.0016, 0.0019, 0.0021, 0.0022, 0.0021, 0.0019, 0.0016, 0.0011, 0.0008, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0010, 0.0016, 0.0023, 0.0029, 0.0034, 0.0036, 0.0037, 0.0036, 0.0034, 0.0029, 0.0023, 0.0016, 0.0010, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0011, 0.0019, 0.0028, 0.0036, 0.0043, 0.0046, 0.0048, 0.0049, 0.0048, 0.0046, 0.0043, 0.0036, 0.0028, 0.0019, 0.0011, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0002, 0.0004, 0.0010, 0.0019, 0.0030, 0.0040, 0.0047, 0.0050, 0.0050, 0.0049, 0.0049, 0.0049, 0.0050, 0.0050, 0.0047, 0.0040, 0.0030, 0.0019, 0.0010, 0.0004, 0.0002, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0003, 0.0008, 0.0016, 0.0028, 0.0040, 0.0048, 0.0050, 0.0047, 0.0043, 0.0039, 0.0037, 0.0039, 0.0043, 0.0047, 0.0050, 0.0048, 0.0040, 0.0028, 0.0016, 0.0008, 0.0003, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0005, 0.0011, 0.0023, 0.0036, 0.0047, 0.0050, 0.0046, 0.0037, 0.0029, 0.0024, 0.0022, 0.0024, 0.0029, 0.0037, 0.0046, 0.0050, 0.0047, 0.0036, 0.0023, 0.0011, 0.0005, 0.0001, 0.0000, 0.0000},
        {0.0001, 0.0002, 0.0007, 0.0016, 0.0029, 0.0043, 0.0050, 0.0047, 0.0037, 0.0026, 0.0017, 0.0012, 0.0010, 0.0012, 0.0017, 0.0026, 0.0037, 0.0047, 0.0050, 0.0043, 0.0029, 0.0016, 0.0007, 0.0002, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0008, 0.0019, 0.0034, 0.0046, 0.0050, 0.0043, 0.0029, 0.0017, 0.0009, 0.0005, 0.0003, 0.0005, 0.0009, 0.0017, 0.0029, 0.0043, 0.0050, 0.0046, 0.0034, 0.0019, 0.0008, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0021, 0.0036, 0.0048, 0.0049, 0.0039, 0.0024, 0.0012, 0.0005, 0.0002, 0.0001, 0.0002, 0.0005, 0.0012, 0.0024, 0.0039, 0.0049, 0.0048, 0.0036, 0.0021, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0022, 0.0037, 0.0049, 0.0049, 0.0037, 0.0022, 0.0010, 0.0003, 0.0001, 0.0000, 0.0001, 0.0003, 0.0010, 0.0022, 0.0037, 0.0049, 0.0049, 0.0037, 0.0022, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0010, 0.0021, 0.0036, 0.0048, 0.0049, 0.0039, 0.0024, 0.0012, 0.0005, 0.0002, 0.0001, 0.0002, 0.0005, 0.0012, 0.0024, 0.0039, 0.0049, 0.0048, 0.0036, 0.0021, 0.0010, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0003, 0.0008, 0.0019, 0.0034, 0.0046, 0.0050, 0.0043, 0.0029, 0.0017, 0.0009, 0.0005, 0.0003, 0.0005, 0.0009, 0.0017, 0.0029, 0.0043, 0.0050, 0.0046, 0.0034, 0.0019, 0.0008, 0.0003, 0.0001, 0.0000},
        {0.0001, 0.0002, 0.0007, 0.0016, 0.0029, 0.0043, 0.0050, 0.0047, 0.0037, 0.0026, 0.0017, 0.0012, 0.0010, 0.0012, 0.0017, 0.0026, 0.0037, 0.0047, 0.0050, 0.0043, 0.0029, 0.0016, 0.0007, 0.0002, 0.0001, 0.0000},
        {0.0000, 0.0001, 0.0005, 0.0011, 0.0023, 0.0036, 0.0047, 0.0050, 0.0046, 0.0037, 0.0029, 0.0024, 0.0022, 0.0024, 0.0029, 0.0037, 0.0046, 0.0050, 0.0047, 0.0036, 0.0023, 0.0011, 0.0005, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0001, 0.0003, 0.0008, 0.0016, 0.0028, 0.0040, 0.0048, 0.0050, 0.0047, 0.0043, 0.0039, 0.0037, 0.0039, 0.0043, 0.0047, 0.0050, 0.0048, 0.0040, 0.0028, 0.0016, 0.0008, 0.0003, 0.0001, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0002, 0.0004, 0.0010, 0.0019, 0.0030, 0.0040, 0.0047, 0.0050, 0.0050, 0.0049, 0.0049, 0.0049, 0.0050, 0.0050, 0.0047, 0.0040, 0.0030, 0.0019, 0.0010, 0.0004, 0.0002, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0011, 0.0019, 0.0028, 0.0036, 0.0043, 0.0046, 0.0048, 0.0049, 0.0048, 0.0046, 0.0043, 0.0036, 0.0028, 0.0019, 0.0011, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0005, 0.0010, 0.0016, 0.0023, 0.0029, 0.0034, 0.0036, 0.0037, 0.0036, 0.0034, 0.0029, 0.0023, 0.0016, 0.0010, 0.0005, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0004, 0.0008, 0.0011, 0.0016, 0.0019, 0.0021, 0.0022, 0.0021, 0.0019, 0.0016, 0.0011, 0.0008, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0002, 0.0003, 0.0005, 0.0007, 0.0008, 0.0010, 0.0010, 0.0010, 0.0008, 0.0007, 0.0005, 0.0003, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0002, 0.0003, 0.0003, 0.0003, 0.0003, 0.0003, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000},
        {0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000}
    };

    Lenia l;

    EXPECT_EQ(l.getTab().size(), tab_expected.size());
    for (size_t i = 0; i < l.getTab().size(); i++) {
        EXPECT_EQ(l.getTab()[i].size(), tab_expected[i].size());
        for (size_t j = 0; j < l.getTab()[i].size(); j++) {
            EXPECT_NEAR(l.getTab()[i][j], tab_expected[i][j], 0.01);
        }
    }
    EXPECT_EQ(l.getKernel().size(), kernel_expected.size());
    for (size_t i = 0; i < l.getKernel().size(); i++) {
        EXPECT_EQ(l.getKernel()[i].size(), kernel_expected[i].size());
        for (size_t j = 0; j < l.getKernel()[i].size(); j++) {
            EXPECT_NEAR(l.getKernel()[i][j], kernel_expected[i][j], 0.001);
        }
    }

    std::vector<std::vector<double> > result = l.calculate();

    std::vector<std::vector<double> > result_expected = {
        {0.04170, 0.04978, 0.05550, 0.05905, 0.06141, 0.06378, 0.06711, 0.07181, 0.07765, 0.08385, 0.08938, 0.09303, 0.09335, 0.08888, 0.07907, 0.06527, 0.05056, 0.03824, 0.03030, 0.02680, 0.02612, 0.02571, 0.02335, 0.01843, 0.01220, 0.00664, 0.00294, 0.00105, 0.00029, 0.00004, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00004, 0.00016, 0.00047, 0.00114, 0.00249, 0.00491, 0.00889, 0.01484, 0.02280, 0.03219},
        {0.04791, 0.05655, 0.06297, 0.06744, 0.07099, 0.07469, 0.07928, 0.08511, 0.09198, 0.09918, 0.10581, 0.11078, 0.11254, 0.10912, 0.09911, 0.08321, 0.06457, 0.04742, 0.03505, 0.02858, 0.02679, 0.02688, 0.02573, 0.02168, 0.01540, 0.00900, 0.00427, 0.00163, 0.00049, 0.00009, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00002, 0.00009, 0.00032, 0.00086, 0.00196, 0.00401, 0.00734, 0.01232, 0.01918, 0.02790, 0.03788},
        {0.05316, 0.06319, 0.07145, 0.07797, 0.08354, 0.08898, 0.09484, 0.10145, 0.10887, 0.11670, 0.12423, 0.13054, 0.13404, 0.13231, 0.12306, 0.10601, 0.08393, 0.06167, 0.04379, 0.03278, 0.02831, 0.02767, 0.02717, 0.02407, 0.01817, 0.01133, 0.00575, 0.00235, 0.00076, 0.00018, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00004, 0.00017, 0.00055, 0.00140, 0.00307, 0.00588, 0.01007, 0.01573, 0.02299, 0.03193, 0.04229},
        {0.05748, 0.06987, 0.08107, 0.09054, 0.09859, 0.10579, 0.11257, 0.11945, 0.12685, 0.13484, 0.14303, 0.15063, 0.15608, 0.15665, 0.14927, 0.13250, 0.10826, 0.08143, 0.05761, 0.04079, 0.03197, 0.02906, 0.02815, 0.02565, 0.02030, 0.01341, 0.00723, 0.00315, 0.00109, 0.00029, 0.00004, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00007, 0.00029, 0.00085, 0.00211, 0.00441, 0.00799, 0.01282, 0.01874, 0.02583, 0.03455, 0.04526},
        {0.06091, 0.07650, 0.09158, 0.10467, 0.11538, 0.12403, 0.13123, 0.13775, 0.14453, 0.15216, 0.16062, 0.16926, 0.17658, 0.17976, 0.17522, 0.16036, 0.13586, 0.10590, 0.07660, 0.05336, 0.03879, 0.03199, 0.02934, 0.02671, 0.02180, 0.01508, 0.00858, 0.00395, 0.00145, 0.00041, 0.00007, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00011, 0.00041, 0.00121, 0.00293, 0.00588, 0.01015, 0.01536, 0.02108, 0.02751, 0.03572, 0.04684},
        {0.06337, 0.08275, 0.10242, 0.11966, 0.13312, 0.14289, 0.14992, 0.15550, 0.16105, 0.16767, 0.17577, 0.18487, 0.19358, 0.19922, 0.19801, 0.18647, 0.16377, 0.13282, 0.09950, 0.07014, 0.04909, 0.03709, 0.03137, 0.02765, 0.02279, 0.01628, 0.00968, 0.00468, 0.00181, 0.00054, 0.00012, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00015, 0.00055, 0.00160, 0.00378, 0.00738, 0.01222, 0.01752, 0.02268, 0.02813, 0.03561, 0.04716},
        {0.06473, 0.08811, 0.11279, 0.13462, 0.15102, 0.16173, 0.16816, 0.17223, 0.17585, 0.18057, 0.18729, 0.19584, 0.20507, 0.21261, 0.21474, 0.20744, 0.18838, 0.15882, 0.12365, 0.08955, 0.06229, 0.04444, 0.03460, 0.02886, 0.02349, 0.01707, 0.01048, 0.00527, 0.00214, 0.00068, 0.00015, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00003, 0.00018, 0.00068, 0.00197, 0.00457, 0.00877, 0.01404, 0.01926, 0.02365, 0.02793, 0.03455, 0.04639},
        {0.06495, 0.09209, 0.12178, 0.14844, 0.16806, 0.17980, 0.18538, 0.18736, 0.18811, 0.18970, 0.19361, 0.20028, 0.20894, 0.21764, 0.22296, 0.22041, 0.20637, 0.18032, 0.14577, 0.10906, 0.07688, 0.05345, 0.03904, 0.03056, 0.02413, 0.01756, 0.01100, 0.00571, 0.00240, 0.00080, 0.00019, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00019, 0.00077, 0.00224, 0.00522, 0.00991, 0.01554, 0.02061, 0.02419, 0.02726, 0.03291, 0.04480},
        {0.06413, 0.09435, 0.12858, 0.15997, 0.18302, 0.19600, 0.20056, 0.19975, 0.19656, 0.19363, 0.19324, 0.19666, 0.20376, 0.21306, 0.22143, 0.22395, 0.21582, 0.19480, 0.16298, 0.12600, 0.09081, 0.06293, 0.04422, 0.03275, 0.02485, 0.01786, 0.01127, 0.00597, 0.00257, 0.00088, 0.00023, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00019, 0.00081, 0.00239, 0.00563, 0.01070, 0.01666, 0.02163, 0.02453, 0.02650, 0.03112, 0.04275},
        {0.06248, 0.09479, 0.13264, 0.16823, 0.19465, 0.20894, 0.21231, 0.20810, 0.20000, 0.19153, 0.18589, 0.18523, 0.19017, 0.19976, 0.21106, 0.21873, 0.21675, 0.20146, 0.17370, 0.13834, 0.10221, 0.07152, 0.04941, 0.03517, 0.02567, 0.01806, 0.01135, 0.00605, 0.00264, 0.00093, 0.00025, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00017, 0.00078, 0.00237, 0.00571, 0.01105, 0.01730, 0.02237, 0.02488, 0.02601, 0.02964, 0.04065},
        {0.06027, 0.09349, 0.13370, 0.17256, 0.20192, 0.21747, 0.21963, 0.21176, 0.19843, 0.18428, 0.17341, 0.16874, 0.17150, 0.18124, 0.19512, 0.20738, 0.21099, 0.20116, 0.17784, 0.14524, 0.10986, 0.07807, 0.05382, 0.03744, 0.02647, 0.01816, 0.01127, 0.00597, 0.00262, 0.00093, 0.00025, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00014, 0.00069, 0.00219, 0.00546, 0.01086, 0.01738, 0.02276, 0.02532, 0.02602, 0.02875, 0.03880},
        {0.05773, 0.09058, 0.13169, 0.17257, 0.20420, 0.22103, 0.22243, 0.21154, 0.19367, 0.17466, 0.15950, 0.15164, 0.15266, 0.16236, 0.17799, 0.19349, 0.20124, 0.19577, 0.17642, 0.14694, 0.11338, 0.08193, 0.05685, 0.03916, 0.02706, 0.01809, 0.01101, 0.00576, 0.00250, 0.00088, 0.00024, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00010, 0.00057, 0.00188, 0.00489, 0.01011, 0.01678, 0.02264, 0.02573, 0.02651, 0.02860, 0.03744},
        {0.05502, 0.08622, 0.12669, 0.16820, 0.20136, 0.21970, 0.22147, 0.20928, 0.18870, 0.16645, 0.14840, 0.13837, 0.13810, 0.14740, 0.16348, 0.18026, 0.19007, 0.18728, 0.17092, 0.14434, 0.11313, 0.08303, 0.05822, 0.04005, 0.02724, 0.01777, 0.01054, 0.00541, 0.00229, 0.00079, 0.00021, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00006, 0.00042, 0.00150, 0.00409, 0.00888, 0.01544, 0.02181, 0.02578, 0.02719, 0.02903, 0.03659},
        {0.05218, 0.08063, 0.11892, 0.15962, 0.19356, 0.21376, 0.21753, 0.20651, 0.18590, 0.16263, 0.14321, 0.13188, 0.13049, 0.13872, 0.15371, 0.16963, 0.17927, 0.17730, 0.16274, 0.13857, 0.10983, 0.08168, 0.05793, 0.03993, 0.02683, 0.01708, 0.00984, 0.00490, 0.00203, 0.00068, 0.00018, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00003, 0.00029, 0.00110, 0.00319, 0.00731, 0.01345, 0.02010, 0.02506, 0.02754, 0.02963, 0.03608},
        {0.04912, 0.07397, 0.10875, 0.14727, 0.18113, 0.20335, 0.21053, 0.20320, 0.18549, 0.16379, 0.14468, 0.13278, 0.13016, 0.13646, 0.14889, 0.16206, 0.16960, 0.16687, 0.15301, 0.13068, 0.10431, 0.07839, 0.05612, 0.03875, 0.02572, 0.01596, 0.00888, 0.00425, 0.00170, 0.00054, 0.00013, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00018, 0.00074, 0.00230, 0.00561, 0.01100, 0.01754, 0.02330, 0.02703, 0.02981, 0.03549},
        {0.04560, 0.06643, 0.09670, 0.13181, 0.16458, 0.18847, 0.19968, 0.19773, 0.18535, 0.16770, 0.15073, 0.13915, 0.13526, 0.13895, 0.14770, 0.15680, 0.16095, 0.15636, 0.14242, 0.12147, 0.09727, 0.07359, 0.05300, 0.03652, 0.02384, 0.01436, 0.00767, 0.00352, 0.00135, 0.00041, 0.00009, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00009, 0.00046, 0.00154, 0.00401, 0.00840, 0.01438, 0.02048, 0.02530, 0.02901, 0.03431},
        {0.04150, 0.05830, 0.08353, 0.11424, 0.14480, 0.16943, 0.18427, 0.18808, 0.18226, 0.17041, 0.15728, 0.14714, 0.14240, 0.14336, 0.14799, 0.15252, 0.15274, 0.14577, 0.13135, 0.11145, 0.08921, 0.06764, 0.04871, 0.03324, 0.02120, 0.01231, 0.00629, 0.00274, 0.00099, 0.00028, 0.00006, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00003, 0.00026, 0.00095, 0.00265, 0.00597, 0.01101, 0.01690, 0.02236, 0.02694, 0.03219},
        {0.03684, 0.05004, 0.07018, 0.09587, 0.12313, 0.14720, 0.16445, 0.17319, 0.17376, 0.16828, 0.16006, 0.15244, 0.14775, 0.14653, 0.14743, 0.14767, 0.14412, 0.13483, 0.11982, 0.10081, 0.08031, 0.06064, 0.04330, 0.02899, 0.01791, 0.00995, 0.00483, 0.00199, 0.00068, 0.00018, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00012, 0.00053, 0.00161, 0.00394, 0.00784, 0.01302, 0.01854, 0.02369, 0.02903},
        {0.03179, 0.04209, 0.05760, 0.07814, 0.10126, 0.12343, 0.14149, 0.15355, 0.15923, 0.15948, 0.15627, 0.15190, 0.14823, 0.14585, 0.14401, 0.14079, 0.13416, 0.12299, 0.10756, 0.08942, 0.07049, 0.05256, 0.03683, 0.02396, 0.01419, 0.00748, 0.00343, 0.00133, 0.00042, 0.00010, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00004, 0.00027, 0.00091, 0.00239, 0.00517, 0.00932, 0.01435, 0.01960, 0.02501},
        {0.02651, 0.03471, 0.04646, 0.06223, 0.08088, 0.10011, 0.11740, 0.13094, 0.13988, 0.14442, 0.14546, 0.14436, 0.14229, 0.13974, 0.13626, 0.13070, 0.12194, 0.10955, 0.09411, 0.07694, 0.05959, 0.04347, 0.02958, 0.01849, 0.01042, 0.00518, 0.00223, 0.00081, 0.00024, 0.00005, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00012, 0.00046, 0.00132, 0.00313, 0.00615, 0.01030, 0.01515, 0.02041},
        {0.02110, 0.02788, 0.03689, 0.04877, 0.06323, 0.07898, 0.09431, 0.10764, 0.11797, 0.12501, 0.12899, 0.13045, 0.12995, 0.12773, 0.12347, 0.11661, 0.10674, 0.09397, 0.07907, 0.06322, 0.04774, 0.03375, 0.02207, 0.01315, 0.00700, 0.00327, 0.00131, 0.00044, 0.00012, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00004, 0.00021, 0.00066, 0.00173, 0.00372, 0.00680, 0.01084, 0.01560},
        {0.01573, 0.02145, 0.02857, 0.03759, 0.04857, 0.06095, 0.07368, 0.08559, 0.09576, 0.10360, 0.10897, 0.11185, 0.11236, 0.11045, 0.10593, 0.09862, 0.08859, 0.07631, 0.06266, 0.04871, 0.03558, 0.02418, 0.01507, 0.00850, 0.00425, 0.00185, 0.00069, 0.00021, 0.00004, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00008, 0.00031, 0.00086, 0.00204, 0.00408, 0.00708, 0.01099},
        {0.01076, 0.01543, 0.02111, 0.02807, 0.03640, 0.04587, 0.05592, 0.06579, 0.07470, 0.08204, 0.08743, 0.09059, 0.09134, 0.08950, 0.08501, 0.07791, 0.06857, 0.05763, 0.04597, 0.03454, 0.02424, 0.01571, 0.00928, 0.00492, 0.00230, 0.00093, 0.00031, 0.00008, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00012, 0.00037, 0.00100, 0.00220, 0.00417, 0.00702},
        {0.00661, 0.01006, 0.01441, 0.01970, 0.02596, 0.03306, 0.04068, 0.04834, 0.05546, 0.06149, 0.06599, 0.06859, 0.06902, 0.06713, 0.06292, 0.05660, 0.04865, 0.03974, 0.03065, 0.02214, 0.01483, 0.00912, 0.00507, 0.00252, 0.00109, 0.00040, 0.00012, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00003, 0.00014, 0.00043, 0.00105, 0.00218, 0.00399},
        {0.00355, 0.00580, 0.00879, 0.01252, 0.01701, 0.02210, 0.02760, 0.03316, 0.03838, 0.04281, 0.04604, 0.04776, 0.04774, 0.04588, 0.04227, 0.03720, 0.03111, 0.02459, 0.01826, 0.01261, 0.00802, 0.00465, 0.00243, 0.00112, 0.00044, 0.00014, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00004, 0.00015, 0.00043, 0.00099, 0.00198},
        {0.00164, 0.00289, 0.00466, 0.00699, 0.00988, 0.01322, 0.01687, 0.02057, 0.02404, 0.02696, 0.02899, 0.02993, 0.02962, 0.02805, 0.02533, 0.02172, 0.01762, 0.01343, 0.00955, 0.00628, 0.00378, 0.00205, 0.00100, 0.00042, 0.00015, 0.00004, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00004, 0.00015, 0.00038, 0.00084},
        {0.00064, 0.00122, 0.00210, 0.00334, 0.00493, 0.00685, 0.00898, 0.01117, 0.01322, 0.01492, 0.01606, 0.01648, 0.01613, 0.01503, 0.01327, 0.01107, 0.00867, 0.00635, 0.00431, 0.00269, 0.00152, 0.00077, 0.00034, 0.00013, 0.00003, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00003, 0.00012, 0.00030},
        {0.00020, 0.00042, 0.00078, 0.00133, 0.00206, 0.00299, 0.00405, 0.00516, 0.00621, 0.00707, 0.00763, 0.00779, 0.00754, 0.00690, 0.00595, 0.00482, 0.00364, 0.00255, 0.00165, 0.00096, 0.00051, 0.00023, 0.00009, 0.00003, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00008},
        {0.00005, 0.00011, 0.00023, 0.00042, 0.00071, 0.00107, 0.00151, 0.00198, 0.00243, 0.00280, 0.00303, 0.00309, 0.00295, 0.00265, 0.00223, 0.00175, 0.00127, 0.00085, 0.00051, 0.00028, 0.00013, 0.00005, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001},
        {0.00000, 0.00002, 0.00005, 0.00010, 0.00019, 0.00031, 0.00045, 0.00061, 0.00077, 0.00090, 0.00098, 0.00100, 0.00094, 0.00083, 0.00068, 0.00051, 0.00035, 0.00022, 0.00012, 0.00006, 0.00002, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00001, 0.00003, 0.00006, 0.00010, 0.00014, 0.00018, 0.00022, 0.00024, 0.00024, 0.00023, 0.00020, 0.00016, 0.00011, 0.00007, 0.00004, 0.00002, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00002, 0.00003, 0.00003, 0.00004, 0.00004, 0.00003, 0.00003, 0.00002, 0.00001, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00000, 0.00000, 0.00001, 0.00001, 0.00002, 0.00002, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00002, 0.00002, 0.00001, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00001, 0.00002, 0.00005, 0.00008, 0.00013, 0.00017, 0.00021, 0.00023, 0.00024, 0.00024, 0.00023, 0.00022, 0.00021, 0.00020, 0.00019, 0.00017, 0.00015, 0.00012, 0.00008, 0.00005, 0.00003, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000},
        {0.00005, 0.00011, 0.00022, 0.00036, 0.00053, 0.00070, 0.00085, 0.00096, 0.00101, 0.00101, 0.00097, 0.00092, 0.00086, 0.00080, 0.00074, 0.00066, 0.00056, 0.00045, 0.00033, 0.00022, 0.00012, 0.00006, 0.00002, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001},
        {0.00020, 0.00042, 0.00074, 0.00117, 0.00167, 0.00216, 0.00259, 0.00290, 0.00306, 0.00308, 0.00299, 0.00283, 0.00262, 0.00240, 0.00217, 0.00192, 0.00164, 0.00133, 0.00100, 0.00069, 0.00043, 0.00023, 0.00010, 0.00003, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00003, 0.00008},
        {0.00065, 0.00123, 0.00206, 0.00310, 0.00423, 0.00535, 0.00632, 0.00704, 0.00745, 0.00754, 0.00737, 0.00696, 0.00641, 0.00580, 0.00517, 0.00453, 0.00388, 0.00320, 0.00249, 0.00179, 0.00117, 0.00068, 0.00034, 0.00013, 0.00004, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00003, 0.00011, 0.00029},
        {0.00169, 0.00300, 0.00474, 0.00678, 0.00893, 0.01099, 0.01274, 0.01408, 0.01490, 0.01517, 0.01488, 0.01410, 0.01296, 0.01161, 0.01025, 0.00894, 0.00770, 0.00646, 0.00519, 0.00391, 0.00271, 0.00167, 0.00090, 0.00041, 0.00015, 0.00004, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00003, 0.00012, 0.00035, 0.00083},
        {0.00376, 0.00624, 0.00931, 0.01268, 0.01604, 0.01910, 0.02168, 0.02367, 0.02499, 0.02554, 0.02522, 0.02405, 0.02211, 0.01973, 0.01728, 0.01501, 0.01299, 0.01112, 0.00925, 0.00731, 0.00535, 0.00353, 0.00204, 0.00101, 0.00041, 0.00014, 0.00002, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00011, 0.00036, 0.00093, 0.00201},
        {0.00727, 0.01130, 0.01590, 0.02056, 0.02489, 0.02861, 0.03169, 0.03410, 0.03587, 0.03684, 0.03672, 0.03533, 0.03269, 0.02920, 0.02544, 0.02197, 0.01905, 0.01657, 0.01427, 0.01186, 0.00922, 0.00652, 0.00406, 0.00217, 0.00097, 0.00036, 0.00010, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00010, 0.00034, 0.00091, 0.00209, 0.00417},
        {0.01248, 0.01817, 0.02405, 0.02949, 0.03406, 0.03774, 0.04072, 0.04324, 0.04540, 0.04695, 0.04742, 0.04628, 0.04336, 0.03894, 0.03381, 0.02890, 0.02487, 0.02180, 0.01932, 0.01685, 0.01396, 0.01059, 0.00712, 0.00412, 0.00200, 0.00080, 0.00026, 0.00004, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00003, 0.00010, 0.00030, 0.00084, 0.00200, 0.00418, 0.00768},
        {0.01921, 0.02624, 0.03277, 0.03811, 0.04210, 0.04508, 0.04757, 0.05009, 0.05272, 0.05516, 0.05665, 0.05635, 0.05370, 0.04872, 0.04222, 0.03556, 0.02998, 0.02602, 0.02338, 0.02126, 0.01873, 0.01529, 0.01111, 0.00695, 0.00365, 0.00158, 0.00056, 0.00015, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00003, 0.00009, 0.00028, 0.00076, 0.00182, 0.00390, 0.00745, 0.01267},
        {0.02685, 0.03461, 0.04102, 0.04558, 0.04856, 0.05069, 0.05285, 0.05565, 0.05909, 0.06271, 0.06554, 0.06647, 0.06455, 0.05939, 0.05159, 0.04279, 0.03493, 0.02931, 0.02605, 0.02427, 0.02261, 0.01983, 0.01559, 0.01056, 0.00600, 0.00281, 0.00107, 0.00033, 0.00005, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00001, 0.00002, 0.00008, 0.00026, 0.00068, 0.00161, 0.00346, 0.00676, 0.01191, 0.01886},
        {0.03457, 0.04254, 0.04846, 0.05218, 0.05441, 0.05622, 0.05865, 0.06222, 0.06681, 0.07175, 0.07599, 0.07829, 0.07740, 0.07239, 0.06342, 0.05215, 0.04119, 0.03280, 0.02789, 0.02585, 0.02502, 0.02343, 0.01987, 0.01456, 0.00894, 0.00452, 0.00186, 0.00061, 0.00015, 0.00001, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00002, 0.00007, 0.00022, 0.00059, 0.00140, 0.00298, 0.00585, 0.01052, 0.01724, 0.02564}
    };

    ASSERT_EQ(result_expected.size(), result.size());
    for (size_t i = 0; i < result_expected.size(); i++) {
        ASSERT_EQ(result_expected[i].size(), result[i].size());
        for (size_t j = 0; j < result_expected[i].size(); j++) {
            ASSERT_NEAR(result_expected[i][j], result[i][j], 0.001);
        }
    }
}

// TEST(LeniaTest, Run) {

//     Lenia l;

//     EXPECT_EQ(g.getTab(), tab_expected);
//     g.run();
//     ASSERT_EQ(g.getTab(), result_expected);
//     g.run();
//     ASSERT_EQ(g.getTab(), tab_expected);
// }
